function dynamicBoardDropdown(n){$(n).html(""),$(".tasks").each(function(){var a=$(this).find(".task-header").text().trim(),e=$(this).find(".task-list-items").attr("id"),s=document.createElement("option");s.appendChild(document.createTextNode(a)),s.value=e,$(n).append(s)})}function classMappingfn(){return{critical:"badge badge-soft-primary",high:"badge badge-soft-danger",low:"badge badge-soft-info",medium:"badge badge-soft-warning",todo:"badge bg-primary",in_progress:"badge bg-warning",review:"badge bg-success",done:"badge bg-danger"}}function taskMappingClassesfn(){return{"bg-primary":"badge badge-primary","bg-secondary":"badge bg-secondary","bg-warning":"badge badge-primary","bg-danger":"badge bg-danger","bg-info":"badge badge-info","bg-success":"badge badge-success","bg-soft-primary":"badge badge-primary","bg-soft-secondary":"badge bg-secondary","bg-soft-warning":"badge badge-primary","bg-soft-danger":"badge bg-danger","bg-soft-info":"badge badge-info","bg-soft-success":"badge badge-success"}}function initializeSortable(){$(".task-list-items").each(function(){Sortable.create($(this)[0],{group:"shared",animation:150,ghostClass:"bg-light"})})}function generateTask(a,i,t,e){var a=$(a).serializeArray(),s=new Date,n=s.getFullYear(),e=e[s.getMonth()],s=s.getDate(),d=document.createElement("div"),o=(d.classList.add("card","border"),""),r="",l="",c='<div class="card-body p-3">';$(a).each(function(a,e){var s,n;"validation-taskname"===e.name&&(o='<div class="inner-header-title mb-2 fs-15"><h6 class="fs-15 fw-semibold mb-0"><a href="#" data-toggle="modal" data-target="#task-detail-modal" class="text-truncate text-dark">'+e.value+'</a></h6><div class="dropdown"><a href="#" class="btn-icon btn-icon-sm btn-icon-soft-primary dropdown-toggle edit-field-icon text-center" data-toggle="dropdown" aria-expanded="false"><i class="mdi mdi-dots-vertical fs-sm"></i></a><div class="dropdown-menu dropdown-menu-right"><a href="javascript:void(0);" class="dropdown-item"><i class="bx bx-edit-alt me-2"></i>Edit</a><a href="javascript:void(0);" class="dropdown-item"><i class="bx bx-user-plus me-2"></i>Add People</a><a href="javascript:void(0);" class="dropdown-item text-warning"><i class="bx bxs-exit me-2"></i>Leave</a><div class="dropdown-divider" ></div><a href="javascript:void(0);" class="dropdown-item text-danger"><i class="bx bx-trash-alt me-2"></i>Delete</a></div></div></div>'),"validation-assignto"===e.name&&((n=(n=e.value).split(" ")).length<2&&(r='<div class="avatar avatar-sm bg-soft-info text-info me-2">'+n[0][0].toUpperCase()+"</div>"),2<=n.length)&&(r='<div class="avatar avatar-sm bg-soft-info text-info me-2">'+n[0][0].toUpperCase()+n[1][0].toUpperCase()+"</div>"),"validation-priority"===e.name&&(s=(n=$("#"+i).siblings("h5").text()).trim(),n=(n=n.trim().toLowerCase()).split(" ").join("_"),l='<div class="clearfix"><span class="'+t[n]+' me-2">'+s+'</span><span class="'+t[e.value]+'">'+e.value+"</span></div>")}),c='<div class="card-body p-3">'+(o+l)+'<div class="d-flex align-items-center text-muted fw-bold mt-4">'+r+'<span class="fs-13 me-2"><i class="bx bx-comment-detail fs-xs align-middle me-1"></i><span class="align-middle"> 0</span></span><span class="fs-13 me-2"><i class="bx bx-check-square fs-xs align-middle me-1"></i><span class="align-middle"> 0</span></span><span class="ms-auto fs-13"><i class="bx bx-calendar fs-xs align-middle me-1"></i><span class="align-middle">'+s+" "+e+" "+n+"</span></span></div>",c=$.parseHTML(c),$(d).append(c),$("#"+i).append(d),document.getElementById("addTaskForm").reset(),document.getElementById("addGeneralTaskForm").reset(),$("#add-task-modal").modal("hide"),$("#add-general-task-modal").modal("hide"),$(".floating-label").removeClass("enable-floating-label")}function generateBoardHTML(a,e){e+=1;var s=taskMappingClassesfn(),n='<div class="tasks">',i="",t=$(a).serializeArray(),d=[],o="",t=($(t).each(function(a,e){"validation-boardtype"===e.name&&(d=e.value.split(",")),"validation-boardname"===e.name&&(o=e.value,i+='<h5 class="task-header">'+e.value+'<button class="btn avatar avatar-xs me-0 waves-effect waves-light addTask" data-toggle="modal" data-target="#add-task-modal"><i class="bx bx-plus fs-sm"></i></span></h5>')}),n+=i+'<div id="task-list-'+e+'" class="task-list-items border border-top-0"></div></div>',n=$.parseHTML(n),$(n).find(".task-header .btn").addClass(d[0]+" "+d[1]),$(".board").append(n),$(a).attr("id")),t=(document.getElementById(t).reset(),$("#add-board-modal").modal("hide"),$(a).find(".floating-label").removeClass("enable-floating-label"),o=(o=o.trim().toLowerCase()).split(" ").join("_"),$(n).find(".task-list-items"));return Sortable.create(t[0],{group:"shared",animation:150,ghostClass:"bg-light"}),{name:o,classes:s[d[1]],boardCount:e}}!function(s){var e,n,i=s(".tasks").length,t=classMappingfn(),d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];s("#comment-btn").on("click",function(){s(this).fadeOut(),s("#comment-form").removeClass("d-none").addClass("d-block")}),s("#comment-submit-btn").on("click",function(){var a=n.getData();alert(a)}),s("#discard-btn").on("click",function(){s("#comment-btn").fadeIn(),s("#comment-form").addClass("d-none").removeClass("d-block"),n.setData("Please Enter Comment")}),initializeSortable(),ClassicEditor.create(document.querySelector("#compose-comment")).then(function(a){n=a}).catch(function(a){console.error("error",a)}),s(document).on("click",".addTask",function(){e=s(this).parent().siblings().attr("id")}),s("#add-general-task-modal").on("shown.bs.modal",function(a){dynamicBoardDropdown(s(this).find(".dynamic-board"))}),s("#remove-task-modal").on("shown.bs.modal",function(a){dynamicBoardDropdown(s(this).find(".dynamic-board"))}),s("#removeBoard").on("click",function(){var a=s(this).parents("#remove-task-modal").find(".dynamic-board").val();s("#"+a).parents(".tasks").remove(),s(this).parents("#remove-task-modal").modal("hide")}),s("#addTaskForm").validate({focusInvalid:!1,rules:{"validation-taskname":{required:!0},"validation-assignto":{required:!0}},errorPlacement:function(a,e){return s(e).siblings(".validation-error").removeClass("d-none"),!0},highlight:function(a){s(a).parents(".form-group").addClass("invalid-field")},unhighlight:function(a){s(a).parents(".form-group").removeClass("invalid-field"),s(a).siblings(".validation-error").addClass("d-none")},submitHandler:function(a){generateTask(a,e,t,d)}}),s("#addBoardForm").validate({focusInvalid:!1,rules:{"validation-boardname":{required:!0}},errorPlacement:function(a,e){return s(e).siblings(".validation-error").removeClass("d-none"),!0},highlight:function(a){s(a).parents(".form-group").addClass("invalid-field")},unhighlight:function(a){s(a).parents(".form-group").removeClass("invalid-field"),s(a).siblings(".validation-error").addClass("d-none")},submitHandler:function(a){a=generateBoardHTML(a,i);t[a.name]=a.classes,i=a.boardCount}}),s("#addGeneralTaskForm").validate({focusInvalid:!1,rules:{"validation-taskname":{required:!0},"validation-assignto":{required:!0}},errorPlacement:function(a,e){return s(e).siblings(".validation-error").removeClass("d-none"),!0},highlight:function(a){s(a).parents(".form-group").addClass("invalid-field")},unhighlight:function(a){s(a).parents(".form-group").removeClass("invalid-field"),s(a).siblings(".validation-error").addClass("d-none")},submitHandler:function(a){generateTask(a,e=s(a).find(".dynamic-board").val(),t,d)}})}(jQuery);